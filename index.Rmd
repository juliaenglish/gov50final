---
title: "Gov 50 Final Project"
author: "Julia English"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts

In education, there are conversations surrounding what contributes most to student success. NYC department of education has open testing data, teacher survey data and demographic data at the school level that I would like to investigate particularly in relation to math scores. 


## Proposal

What is correlated with student success in math? For this data analysis, I'm interested in working with multiple data sets from the New York City Department of Education including the 2017 School Math results, the school level demographic snapshot and the public teacher data files. As many classroom teachers know, there are multiple factors that can correlate with student success, beyond instruction in the classroom. I want to specifically look at the relationship between "collaborative" teachers with regards to math outcomes while holding for possible confounding variables that might obscure this relationship. My outcome variable would be 2017 math scores on the school level. There are a range of possible levels which range from 134-400. My predictor variable would be collaborative teacher scores measured on a scale from 1-10. I want to run a multiple regression as variables in education are usually intertwined. For example, teaching a high percentage of English Language Learners might affect how students complete complicated state test word problems. Holding these covariants constant and still seeing a statistically significant association would be convincing evidence. 


```{r}
library(ggExtra)
library(tidyverse)
library(ggplot2)
library(foreign)

teachers <- read.csv("2017_Public_Data_File_Teacher.csv")
math <- read.csv("2013-2017_School_Math_Results_-_All.csv")
demographics <- read.csv("2013_-_2018_Demographic_Snapshot_School.csv")

math_sub <- math %>% 
  filter(Year == 2017,
         Grade == 8) %>% 
  select(DBN, School.Name, Year, Number.Tested, Mean.Scale.Score) 

math_sub <- left_join(
    math_sub, 
    teachers |> select(-School.Name)) |>
  left_join(
      demographics |> 
        select(-School.Name) |>
        filter(Year == "2016-17") |>
        mutate(Year = 2017))

```

```{r univariate distributions}



math_sub$Mean.Scale.Score <- as.numeric(math_sub$Mean.Scale.Score)

math_sub <- math_sub %>%
  mutate(b = str_sub(math_sub$DBN,3,3))

math_sub <- math_sub %>%
  mutate(Borough = case_when(is.na(b) ~ "Unknown", b == "M" ~ "Manhattan",
                             b == "K" ~ "Brooklyn",
                             b == "Q" ~ "Queens",
                             b == "X" ~ "Bronx",
                             b == "R" ~ "Staten Island"))

math_sub <- math_sub %>%
  mutate(district = str_sub(math_sub$DBN,1,2))  

math.plot <- math_sub %>% 
  ggplot(mapping = aes(x = Mean.Scale.Score)) +
  geom_histogram(color = "black", fill = "cadetblue1") +
  labs(title = "Histogram of 2017 Math Scores for the 8th Grade",
       x = "Average School Math Score",
       y = "Count") +
  geom_vline(aes(xintercept = 322), color = "violet") 
  
  

math.plot

math.plot2 <- math_sub %>% 
  ggplot(mapping = aes(x = Mean.Scale.Score)) +
  geom_histogram(color = "black", fill = "seagreen") +
  labs(title = "Histogram of 2017 Math Scores for the 8th Grade",
       x = "Average School Math Score",
       y = "Count") +
  geom_vline(aes(xintercept = 322), color = "violet") +
  facet_wrap(~ Borough)
  

math.plot2

math_summary <- math_sub %>% 
  drop_na() %>% 
  select(Mean.Scale.Score) %>% 
  summary()

knitr::kable(math_summary, col.names = "Summary of Average Math Scores")

```
The purple line indicates the proficiency level for 2017 for 8th grade math students. 

```{r}

teachers$Collaborative.Teachers.Score <- as.numeric(teachers$Collaborative.Teachers.Score)

math_sub$Collaborative.Teachers.Score <- as.numeric(math_sub$Collaborative.Teachers.Score)

teachers$Rigorous.Instruction.Score <- as.numeric(teachers$Rigorous.Instruction.Score)


teacher.effectiveness <- math_sub %>% 
  ggplot(mapping = aes(x = Collaborative.Teachers.Score,
                       y = Mean.Scale.Score)) +
  geom_point() +
  labs(x = "Collaborative Teachers Score",
       y = "Average Math Score") 

teacher.effectiveness

teacher.instruction <- teachers %>% 
  ggplot(mapping = aes(x = Collaborative.Teachers.Score)) +
  geom_boxplot()

teacher.instruction
```

```{r}
fit <- lm(Mean.Scale.Score ~ Collaborative.Teachers.Score, data = math_sub)

summary(fit)


fit.controls <- lm(Mean.Scale.Score ~ Collaborative.Teachers.Score + X..Poverty.1 + X..English.Language.Learners.1 + X..Students.with.Disabilities.1, data = math_sub)

summary(fit.controls)


confint(fit.controls)


```

In the fitted model with the controls we can see there is a positive association between the teacher collaborative score and average math score. An increase in a collaborative score of 1 unit would predict a six point difference in resulting math scores. Our p value is below .01 which means we have enough evidence to reject the null hypothesis of no association. 